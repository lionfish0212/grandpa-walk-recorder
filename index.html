<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>é˜¿å…¬æ•£æ­¥æé†’ï¼‹èªéŸ³æ—¥è¨˜</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
  h1, h2 { color: #2c3e50; }
  button { font-size: 16px; padding: 10px 20px; margin: 10px 5px 10px 0; }
  #timer { font-size: 48px; margin: 20px 0; }
  #status, #recordStatus { font-size: 18px; margin-top: 10px; }
  select { font-size: 16px; padding: 5px; }
  .record-item { margin-top: 10px; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
  .record-title { font-weight: bold; }
  .record-time { font-size: 12px; color: gray; }
  audio { width: 100%; margin-top: 5px; }
  label, input { display: block; margin: 8px 0 4px; font-size: 16px; }
  input { padding: 8px; width: 300px; max-width: 90vw; }
  .delete-btn {
    background: #e74c3c;
    border: none;
    color: white;
    padding: 5px 10px;
    border-radius: 3px;
    cursor: pointer;
    margin-top: 6px;
    font-size: 14px;
  }
</style>
</head>
<body>

<h1>é˜¿å…¬æ•£æ­¥æé†’ + æ„Ÿè¦ºè¨˜éŒ„</h1>
<p>é£¯å¾Œ10åˆ†é˜é–‹å§‹æ•£æ­¥ï¼ŒæŒ‰ä¸‹ã€Œé–‹å§‹æ•£æ­¥ã€å¾Œè‡ªå‹•è¨ˆæ™‚ã€‚</p>
<button id="startBtn">é–‹å§‹æ•£æ­¥</button>
<div id="timer">10:00</div>
<div id="status"></div>
<label for="feelSelect">ä»Šå¤©æ•£æ­¥æ„Ÿè¦ºï¼š</label>
<select id="feelSelect">
  <option value="">--é¸æ“‡ç‹€æ…‹--</option>
  <option value="è¼•é¬†">è¼•é¬†</option>
  <option value="ç–²ç´¯">ç–²ç´¯</option>
  <option value="æ²’æ•£æ­¥">æ²’æ•£æ­¥</option>
</select>
<button id="saveFeelBtn">ä¿å­˜ç‹€æ…‹</button>
<div id="savedFeel"></div>

<hr />

<h2>å®¶åº­èªéŸ³ç•™è¨€æ¿</h2>

<label for="nameInput">ç•™è¨€è€…å§“åï¼š</label>
<input type="text" id="nameInput" placeholder="è«‹è¼¸å…¥å§“å" />

<label for="titleInput">ç•™è¨€ä¸»é¡Œï¼š</label>
<input type="text" id="titleInput" placeholder="è«‹è¼¸å…¥ç•™è¨€ä¸»é¡Œ" />

<button id="startRecBtn">é–‹å§‹éŒ„éŸ³ ğŸ™ï¸</button>
<button id="stopRecBtn" disabled>åœæ­¢éŒ„éŸ³ â¹ï¸</button>
<div id="recordStatus"></div>

<h2>ç•™è¨€æ¸…å–®</h2>
<div id="recordList"></div>

<script>
  const startBtn = document.getElementById('startBtn');
  const timerDisplay = document.getElementById('timer');
  const status = document.getElementById('status');
  let timer = 600;
  let intervalId;

  function updateTimer() {
    const min = Math.floor(timer / 60).toString().padStart(2, '0');
    const sec = (timer % 60).toString().padStart(2, '0');
    timerDisplay.textContent = `${min}:${sec}`;
    if (timer <= 0) {
      clearInterval(intervalId);
      status.textContent = 'æ­å–œå®Œæˆæ•£æ­¥ï¼ğŸ’ª';
      if ('Notification' in window && Notification.permission === 'granted') {
        new Notification('æ•£æ­¥æ™‚é–“åˆ°å›‰ï¼');
      }
      startBtn.disabled = false;
    }
    timer--;
  }

  startBtn.addEventListener('click', () => {
    if (!('Notification' in window)) {
      startCountdown();
      return;
    }

    if (Notification.permission === 'granted') {
      startCountdown();
    } else if (Notification.permission !== 'denied') {
      Notification.requestPermission().then(p => {
        startCountdown(); // ç„¡è«–æ˜¯å¦æˆæ¬Šï¼Œéƒ½é–‹å§‹è¨ˆæ™‚
      });
    } else {
      startCountdown();
    }
  });

  function startCountdown() {
    timer = 600;
    startBtn.disabled = true;
    status.textContent = 'æ•£æ­¥ä¸­...åŠ æ²¹ï¼';
    updateTimer();
    intervalId = setInterval(updateTimer, 1000);
  }  // æ•£æ­¥æ„Ÿè¦ºè¨˜éŒ„ï¼‹æ­·å²ç‹€æ…‹é¡¯ç¤º
  const feelSelect = document.getElementById('feelSelect');
  const saveFeelBtn = document.getElementById('saveFeelBtn');
  const savedFeel = document.getElementById('savedFeel');

  function getTodayKey() {
    return new Date().toISOString().slice(0, 10);
  }

  function saveFeel() {
    const val = feelSelect.value;
    if (!val) {
      alert('è«‹é¸æ“‡æ•£æ­¥æ„Ÿè¦º');
      return;
    }

    const today = getTodayKey();
    let history = JSON.parse(localStorage.getItem('feelHistory') || '{}');
    history[today] = val;
    localStorage.setItem('feelHistory', JSON.stringify(history));
    updateFeelDisplay();
  }

  function updateFeelDisplay() {
    const today = getTodayKey();
    const history = JSON.parse(localStorage.getItem('feelHistory') || '{}');
    const todayStatus = history[today];
    if (todayStatus) {
      savedFeel.textContent = `ä»Šå¤© (${today}) çš„ç‹€æ…‹ï¼š${todayStatus}`;
      feelSelect.value = todayStatus;
    } else {
      savedFeel.textContent = 'ä»Šå¤©å°šæœªè¨˜éŒ„æ•£æ­¥ç‹€æ…‹';
    }
  }

  saveFeelBtn.addEventListener('click', saveFeel);
  updateFeelDisplay();


  // å…¶ä»–ç¨‹å¼ç¢¼ä¿æŒä¸è®Š...
</script>

</body>
</html>
